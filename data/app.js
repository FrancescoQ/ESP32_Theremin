var dt=Object.defineProperty,ut=Object.defineProperties;var ht=Object.getOwnPropertyDescriptors;var Me=Object.getOwnPropertySymbols;var ft=Object.prototype.hasOwnProperty,mt=Object.prototype.propertyIsEnumerable;var Oe=(e,t,n)=>t in e?dt(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,P=(e,t)=>{for(var n in t||(t={}))ft.call(t,n)&&Oe(e,n,t[n]);if(Me)for(var n of Me(t))mt.call(t,n)&&Oe(e,n,t[n]);return e},j=(e,t)=>ut(e,ht(t));(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))s(o);new MutationObserver(o=>{for(const a of o)if(a.type==="childList")for(const d of a.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&s(d)}).observe(document,{childList:!0,subtree:!0});function n(o){const a={};return o.integrity&&(a.integrity=o.integrity),o.referrerPolicy&&(a.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?a.credentials="include":o.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function s(o){if(o.ep)return;o.ep=!0;const a=n(o);fetch(o.href,a)}})();var ie,w,Be,K,Te,ze,Ke,Ge,ke,ge,pe,Je,X={},Ye=[],_t=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,ce=Array.isArray;function V(e,t){for(var n in t)e[n]=t[n];return e}function we(e){e&&e.parentNode&&e.parentNode.removeChild(e)}function Se(e,t,n){var s,o,a,d={};for(a in t)a=="key"?s=t[a]:a=="ref"?o=t[a]:d[a]=t[a];if(arguments.length>2&&(d.children=arguments.length>3?ie.call(arguments,2):n),typeof e=="function"&&e.defaultProps!=null)for(a in e.defaultProps)d[a]===void 0&&(d[a]=e.defaultProps[a]);return ne(e,d,s,o,null)}function ne(e,t,n,s,o){var a={type:e,props:t,key:n,ref:s,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:o==null?++Be:o,__i:-1,__u:0};return o==null&&w.vnode!=null&&w.vnode(a),a}function Z(e){return e.children}function ae(e,t){this.props=e,this.context=t}function G(e,t){if(t==null)return e.__?G(e.__,e.__i+1):null;for(var n;t<e.__k.length;t++)if((n=e.__k[t])!=null&&n.__e!=null)return n.__e;return typeof e.type=="function"?G(e):null}function Qe(e){var t,n;if((e=e.__)!=null&&e.__c!=null){for(e.__e=e.__c.base=null,t=0;t<e.__k.length;t++)if((n=e.__k[t])!=null&&n.__e!=null){e.__e=e.__c.base=n.__e;break}return Qe(e)}}function be(e){(!e.__d&&(e.__d=!0)&&K.push(e)&&!oe.__r++||Te!=w.debounceRendering)&&((Te=w.debounceRendering)||ze)(oe)}function oe(){for(var e,t,n,s,o,a,d,i=1;K.length;)K.length>i&&K.sort(Ke),e=K.shift(),i=K.length,e.__d&&(n=void 0,s=void 0,o=(s=(t=e).__v).__e,a=[],d=[],t.__P&&((n=V({},s)).__v=s.__v+1,w.vnode&&w.vnode(n),Ne(t.__P,n,s,t.__n,t.__P.namespaceURI,32&s.__u?[o]:null,a,o==null?G(s):o,!!(32&s.__u),d),n.__v=s.__v,n.__.__k[n.__i]=n,et(a,n,d),s.__e=s.__=null,n.__e!=o&&Qe(n)));oe.__r=0}function Xe(e,t,n,s,o,a,d,i,u,c,h){var l,m,_,x,k,p,f,g=s&&s.__k||Ye,M=t.length;for(u=gt(n,t,g,u,M),l=0;l<M;l++)(_=n.__k[l])!=null&&(m=_.__i==-1?X:g[_.__i]||X,_.__i=l,p=Ne(e,_,m,o,a,d,i,u,c,h),x=_.__e,_.ref&&m.ref!=_.ref&&(m.ref&&Fe(m.ref,null,_),h.push(_.ref,_.__c||x,_)),k==null&&x!=null&&(k=x),(f=!!(4&_.__u))||m.__k===_.__k?u=Ze(_,u,e,f):typeof _.type=="function"&&p!==void 0?u=p:x&&(u=x.nextSibling),_.__u&=-7);return n.__e=k,u}function gt(e,t,n,s,o){var a,d,i,u,c,h=n.length,l=h,m=0;for(e.__k=new Array(o),a=0;a<o;a++)(d=t[a])!=null&&typeof d!="boolean"&&typeof d!="function"?(u=a+m,(d=e.__k[a]=typeof d=="string"||typeof d=="number"||typeof d=="bigint"||d.constructor==String?ne(null,d,null,null,null):ce(d)?ne(Z,{children:d},null,null,null):d.constructor==null&&d.__b>0?ne(d.type,d.props,d.key,d.ref?d.ref:null,d.__v):d).__=e,d.__b=e.__b+1,i=null,(c=d.__i=pt(d,n,u,l))!=-1&&(l--,(i=n[c])&&(i.__u|=2)),i==null||i.__v==null?(c==-1&&(o>h?m--:o<h&&m++),typeof d.type!="function"&&(d.__u|=4)):c!=u&&(c==u-1?m--:c==u+1?m++:(c>u?m--:m++,d.__u|=4))):e.__k[a]=null;if(l)for(a=0;a<h;a++)(i=n[a])!=null&&!(2&i.__u)&&(i.__e==s&&(s=G(i)),rt(i,i));return s}function Ze(e,t,n,s){var o,a;if(typeof e.type=="function"){for(o=e.__k,a=0;o&&a<o.length;a++)o[a]&&(o[a].__=e,t=Ze(o[a],t,n,s));return t}e.__e!=t&&(s&&(t&&e.type&&!t.parentNode&&(t=G(e)),n.insertBefore(e.__e,t||null)),t=e.__e);do t=t&&t.nextSibling;while(t!=null&&t.nodeType==8);return t}function pt(e,t,n,s){var o,a,d,i=e.key,u=e.type,c=t[n],h=c!=null&&(2&c.__u)==0;if(c===null&&e.key==null||h&&i==c.key&&u==c.type)return n;if(s>(h?1:0)){for(o=n-1,a=n+1;o>=0||a<t.length;)if((c=t[d=o>=0?o--:a++])!=null&&!(2&c.__u)&&i==c.key&&u==c.type)return d}return-1}function De(e,t,n){t[0]=="-"?e.setProperty(t,n==null?"":n):e[t]=n==null?"":typeof n!="number"||_t.test(t)?n:n+"px"}function te(e,t,n,s,o){var a,d;e:if(t=="style")if(typeof n=="string")e.style.cssText=n;else{if(typeof s=="string"&&(e.style.cssText=s=""),s)for(t in s)n&&t in n||De(e.style,t,"");if(n)for(t in n)s&&n[t]==s[t]||De(e.style,t,n[t])}else if(t[0]=="o"&&t[1]=="n")a=t!=(t=t.replace(Ge,"$1")),d=t.toLowerCase(),t=d in e||t=="onFocusOut"||t=="onFocusIn"?d.slice(2):t.slice(2),e.l||(e.l={}),e.l[t+a]=n,n?s?n.u=s.u:(n.u=ke,e.addEventListener(t,a?pe:ge,a)):e.removeEventListener(t,a?pe:ge,a);else{if(o=="http://www.w3.org/2000/svg")t=t.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if(t!="width"&&t!="height"&&t!="href"&&t!="list"&&t!="form"&&t!="tabIndex"&&t!="download"&&t!="rowSpan"&&t!="colSpan"&&t!="role"&&t!="popover"&&t in e)try{e[t]=n==null?"":n;break e}catch(i){}typeof n=="function"||(n==null||n===!1&&t[4]!="-"?e.removeAttribute(t):e.setAttribute(t,t=="popover"&&n==1?"":n))}}function Pe(e){return function(t){if(this.l){var n=this.l[t.type+e];if(t.t==null)t.t=ke++;else if(t.t<n.u)return;return n(w.event?w.event(t):t)}}}function Ne(e,t,n,s,o,a,d,i,u,c){var h,l,m,_,x,k,p,f,g,M,O,D,L,I,b,v,F,y=t.type;if(t.constructor!=null)return null;128&n.__u&&(u=!!(32&n.__u),a=[i=t.__e=n.__e]),(h=w.__b)&&h(t);e:if(typeof y=="function")try{if(f=t.props,g="prototype"in y&&y.prototype.render,M=(h=y.contextType)&&s[h.__c],O=h?M?M.props.value:h.__:s,n.__c?p=(l=t.__c=n.__c).__=l.__E:(g?t.__c=l=new y(f,O):(t.__c=l=new ae(f,O),l.constructor=y,l.render=yt),M&&M.sub(l),l.props=f,l.state||(l.state={}),l.context=O,l.__n=s,m=l.__d=!0,l.__h=[],l._sb=[]),g&&l.__s==null&&(l.__s=l.state),g&&y.getDerivedStateFromProps!=null&&(l.__s==l.state&&(l.__s=V({},l.__s)),V(l.__s,y.getDerivedStateFromProps(f,l.__s))),_=l.props,x=l.state,l.__v=t,m)g&&y.getDerivedStateFromProps==null&&l.componentWillMount!=null&&l.componentWillMount(),g&&l.componentDidMount!=null&&l.__h.push(l.componentDidMount);else{if(g&&y.getDerivedStateFromProps==null&&f!==_&&l.componentWillReceiveProps!=null&&l.componentWillReceiveProps(f,O),!l.__e&&l.shouldComponentUpdate!=null&&l.shouldComponentUpdate(f,l.__s,O)===!1||t.__v==n.__v){for(t.__v!=n.__v&&(l.props=f,l.state=l.__s,l.__d=!1),t.__e=n.__e,t.__k=n.__k,t.__k.some(function(C){C&&(C.__=t)}),D=0;D<l._sb.length;D++)l.__h.push(l._sb[D]);l._sb=[],l.__h.length&&d.push(l);break e}l.componentWillUpdate!=null&&l.componentWillUpdate(f,l.__s,O),g&&l.componentDidUpdate!=null&&l.__h.push(function(){l.componentDidUpdate(_,x,k)})}if(l.context=O,l.props=f,l.__P=e,l.__e=!1,L=w.__r,I=0,g){for(l.state=l.__s,l.__d=!1,L&&L(t),h=l.render(l.props,l.state,l.context),b=0;b<l._sb.length;b++)l.__h.push(l._sb[b]);l._sb=[]}else do l.__d=!1,L&&L(t),h=l.render(l.props,l.state,l.context),l.state=l.__s;while(l.__d&&++I<25);l.state=l.__s,l.getChildContext!=null&&(s=V(V({},s),l.getChildContext())),g&&!m&&l.getSnapshotBeforeUpdate!=null&&(k=l.getSnapshotBeforeUpdate(_,x)),v=h,h!=null&&h.type===Z&&h.key==null&&(v=tt(h.props.children)),i=Xe(e,ce(v)?v:[v],t,n,s,o,a,d,i,u,c),l.base=t.__e,t.__u&=-161,l.__h.length&&d.push(l),p&&(l.__E=l.__=null)}catch(C){if(t.__v=null,u||a!=null)if(C.then){for(t.__u|=u?160:128;i&&i.nodeType==8&&i.nextSibling;)i=i.nextSibling;a[a.indexOf(i)]=null,t.__e=i}else{for(F=a.length;F--;)we(a[F]);ye(t)}else t.__e=n.__e,t.__k=n.__k,C.then||ye(t);w.__e(C,t,n)}else a==null&&t.__v==n.__v?(t.__k=n.__k,t.__e=n.__e):i=t.__e=bt(n.__e,t,n,s,o,a,d,u,c);return(h=w.diffed)&&h(t),128&t.__u?void 0:i}function ye(e){e&&e.__c&&(e.__c.__e=!0),e&&e.__k&&e.__k.forEach(ye)}function et(e,t,n){for(var s=0;s<n.length;s++)Fe(n[s],n[++s],n[++s]);w.__c&&w.__c(t,e),e.some(function(o){try{e=o.__h,o.__h=[],e.some(function(a){a.call(o)})}catch(a){w.__e(a,o.__v)}})}function tt(e){return typeof e!="object"||e==null||e.__b&&e.__b>0?e:ce(e)?e.map(tt):V({},e)}function bt(e,t,n,s,o,a,d,i,u){var c,h,l,m,_,x,k,p=n.props,f=t.props,g=t.type;if(g=="svg"?o="http://www.w3.org/2000/svg":g=="math"?o="http://www.w3.org/1998/Math/MathML":o||(o="http://www.w3.org/1999/xhtml"),a!=null){for(c=0;c<a.length;c++)if((_=a[c])&&"setAttribute"in _==!!g&&(g?_.localName==g:_.nodeType==3)){e=_,a[c]=null;break}}if(e==null){if(g==null)return document.createTextNode(f);e=document.createElementNS(o,g,f.is&&f),i&&(w.__m&&w.__m(t,a),i=!1),a=null}if(g==null)p===f||i&&e.data==f||(e.data=f);else{if(a=a&&ie.call(e.childNodes),p=n.props||X,!i&&a!=null)for(p={},c=0;c<e.attributes.length;c++)p[(_=e.attributes[c]).name]=_.value;for(c in p)if(_=p[c],c!="children"){if(c=="dangerouslySetInnerHTML")l=_;else if(!(c in f)){if(c=="value"&&"defaultValue"in f||c=="checked"&&"defaultChecked"in f)continue;te(e,c,null,_,o)}}for(c in f)_=f[c],c=="children"?m=_:c=="dangerouslySetInnerHTML"?h=_:c=="value"?x=_:c=="checked"?k=_:i&&typeof _!="function"||p[c]===_||te(e,c,_,p[c],o);if(h)i||l&&(h.__html==l.__html||h.__html==e.innerHTML)||(e.innerHTML=h.__html),t.__k=[];else if(l&&(e.innerHTML=""),Xe(t.type=="template"?e.content:e,ce(m)?m:[m],t,n,s,g=="foreignObject"?"http://www.w3.org/1999/xhtml":o,a,d,a?a[0]:n.__k&&G(n,0),i,u),a!=null)for(c=a.length;c--;)we(a[c]);i||(c="value",g=="progress"&&x==null?e.removeAttribute("value"):x!=null&&(x!==e[c]||g=="progress"&&!x||g=="option"&&x!=p[c])&&te(e,c,x,p[c],o),c="checked",k!=null&&k!=e[c]&&te(e,c,k,p[c],o))}return e}function Fe(e,t,n){try{if(typeof e=="function"){var s=typeof e.__u=="function";s&&e.__u(),s&&t==null||(e.__u=e(t))}else e.current=t}catch(o){w.__e(o,n)}}function rt(e,t,n){var s,o;if(w.unmount&&w.unmount(e),(s=e.ref)&&(s.current&&s.current!=e.__e||Fe(s,null,t)),(s=e.__c)!=null){if(s.componentWillUnmount)try{s.componentWillUnmount()}catch(a){w.__e(a,t)}s.base=s.__P=null}if(s=e.__k)for(o=0;o<s.length;o++)s[o]&&rt(s[o],t,n||typeof e.type!="function");n||we(e.__e),e.__c=e.__=e.__e=void 0}function yt(e,t,n){return this.constructor(e,n)}function xt(e,t,n){var s,o,a,d;t==document&&(t=document.documentElement),w.__&&w.__(e,t),o=(s=!1)?null:t.__k,a=[],d=[],Ne(t,e=t.__k=Se(Z,null,[e]),o||X,X,t.namespaceURI,o?null:t.firstChild?ie.call(t.childNodes):null,a,o?o.__e:t.firstChild,s,d),et(a,e,d)}function vt(e){function t(n){var s,o;return this.getChildContext||(s=new Set,(o={})[t.__c]=this,this.getChildContext=function(){return o},this.componentWillUnmount=function(){s=null},this.shouldComponentUpdate=function(a){this.props.value!=a.value&&s.forEach(function(d){d.__e=!0,be(d)})},this.sub=function(a){s.add(a);var d=a.componentWillUnmount;a.componentWillUnmount=function(){s&&s.delete(a),d&&d.call(a)}}),n.children}return t.__c="__cC"+Je++,t.__=e,t.Provider=t.__l=(t.Consumer=function(n,s){return n.children(s)}).contextType=t,t}ie=Ye.slice,w={__e:function(e,t,n,s){for(var o,a,d;t=t.__;)if((o=t.__c)&&!o.__)try{if((a=o.constructor)&&a.getDerivedStateFromError!=null&&(o.setState(a.getDerivedStateFromError(e)),d=o.__d),o.componentDidCatch!=null&&(o.componentDidCatch(e,s||{}),d=o.__d),d)return o.__E=o}catch(i){e=i}throw e}},Be=0,ae.prototype.setState=function(e,t){var n;n=this.__s!=null&&this.__s!=this.state?this.__s:this.__s=V({},this.state),typeof e=="function"&&(e=e(V({},n),this.props)),e&&V(n,e),e!=null&&this.__v&&(t&&this._sb.push(t),be(this))},ae.prototype.forceUpdate=function(e){this.__v&&(this.__e=!0,e&&this.__h.push(e),be(this))},ae.prototype.render=Z,K=[],ze=typeof Promise=="function"?Promise.prototype.then.bind(Promise.resolve()):setTimeout,Ke=function(e,t){return e.__v.__b-t.__v.__b},oe.__r=0,Ge=/(PointerCapture)$|Capture$/i,ke=0,ge=Pe(!1),pe=Pe(!0),Je=0;var kt=0;function r(e,t,n,s,o,a){t||(t={});var d,i,u=t;if("ref"in u)for(i in u={},t)i=="ref"?d=t[i]:u[i]=t[i];var c={type:e,props:u,key:n,ref:d,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:--kt,__i:-1,__u:0,__source:o,__self:a};if(typeof e=="function"&&(d=e.defaultProps))for(i in d)u[i]===void 0&&(u[i]=d[i]);return w.vnode&&w.vnode(c),c}var J,N,ue,We,le=0,nt=[],E=w,Ae=E.__b,Le=E.__r,Re=E.diffed,Ue=E.__c,je=E.unmount,Ve=E.__;function de(e,t){E.__h&&E.__h(N,e,le||t),le=0;var n=N.__H||(N.__H={__:[],__h:[]});return e>=n.__.length&&n.__.push({}),n.__[e]}function S(e){return le=1,wt(st,e)}function wt(e,t,n){var s=de(J++,2);if(s.t=e,!s.__c&&(s.__=[st(void 0,t),function(i){var u=s.__N?s.__N[0]:s.__[0],c=s.t(u,i);u!==c&&(s.__N=[c,s.__[1]],s.__c.setState({}))}],s.__c=N,!N.__f)){var o=function(i,u,c){if(!s.__c.__H)return!0;var h=s.__c.__H.__.filter(function(m){return!!m.__c});if(h.every(function(m){return!m.__N}))return!a||a.call(this,i,u,c);var l=s.__c.props!==i;return h.forEach(function(m){if(m.__N){var _=m.__[0];m.__=m.__N,m.__N=void 0,_!==m.__[0]&&(l=!0)}}),a&&a.call(this,i,u,c)||l};N.__f=!0;var a=N.shouldComponentUpdate,d=N.componentWillUpdate;N.componentWillUpdate=function(i,u,c){if(this.__e){var h=a;a=void 0,o(i,u,c),a=h}d&&d.call(this,i,u,c)},N.shouldComponentUpdate=o}return s.__N||s.__}function T(e,t){var n=de(J++,3);!E.__s&&at(n.__H,t)&&(n.__=e,n.u=t,N.__H.__h.push(n))}function St(e,t){var n=de(J++,7);return at(n.__H,t)&&(n.__=e(),n.__H=t,n.__h=e),n.__}function Nt(e,t){return le=8,St(function(){return e},t)}function Ft(e){var t=N.context[e.__c],n=de(J++,9);return n.c=e,t?(n.__==null&&(n.__=!0,t.sub(N)),t.props.value):e.__}function Et(){for(var e;e=nt.shift();)if(e.__P&&e.__H)try{e.__H.__h.forEach(se),e.__H.__h.forEach(xe),e.__H.__h=[]}catch(t){e.__H.__h=[],E.__e(t,e.__v)}}E.__b=function(e){N=null,Ae&&Ae(e)},E.__=function(e,t){e&&t.__k&&t.__k.__m&&(e.__m=t.__k.__m),Ve&&Ve(e,t)},E.__r=function(e){Le&&Le(e),J=0;var t=(N=e.__c).__H;t&&(ue===N?(t.__h=[],N.__h=[],t.__.forEach(function(n){n.__N&&(n.__=n.__N),n.u=n.__N=void 0})):(t.__h.forEach(se),t.__h.forEach(xe),t.__h=[],J=0)),ue=N},E.diffed=function(e){Re&&Re(e);var t=e.__c;t&&t.__H&&(t.__H.__h.length&&(nt.push(t)!==1&&We===E.requestAnimationFrame||((We=E.requestAnimationFrame)||Ct)(Et)),t.__H.__.forEach(function(n){n.u&&(n.__H=n.u),n.u=void 0})),ue=N=null},E.__c=function(e,t){t.some(function(n){try{n.__h.forEach(se),n.__h=n.__h.filter(function(s){return!s.__||xe(s)})}catch(s){t.some(function(o){o.__h&&(o.__h=[])}),t=[],E.__e(s,n.__v)}}),Ue&&Ue(e,t)},E.unmount=function(e){je&&je(e);var t,n=e.__c;n&&n.__H&&(n.__H.__.forEach(function(s){try{se(s)}catch(o){t=o}}),n.__H=void 0,t&&E.__e(t,n.__v))};var qe=typeof requestAnimationFrame=="function";function Ct(e){var t,n=function(){clearTimeout(s),qe&&cancelAnimationFrame(t),setTimeout(e)},s=setTimeout(n,35);qe&&(t=requestAnimationFrame(n))}function se(e){var t=N,n=e.__c;typeof n=="function"&&(e.__c=void 0,n()),N=t}function xe(e){var t=N;e.__c=e.__(),N=t}function at(e,t){return!e||e.length!==t.length||t.some(function(n,s){return n!==e[s]})}function st(e,t){return typeof t=="function"?t(e):t}const ot=vt(null);function $t({children:e,url:t}){const[n,s]=S(null),[o,a]=S(!1),[d,i]=S({oscillators:{},effects:{},sensor:{},performance:{},system:{},tuner:{}}),[u,c]=S(null);T(()=>{let m,_;const x=()=>{try{const k=t||`ws://${window.location.hostname}/ws`;m=new WebSocket(k),m.onopen=()=>{console.log("WebSocket connected"),a(!0),c(null)},m.onmessage=p=>{try{const f=JSON.parse(p.data);f.type==="complete"?i({oscillators:f.oscillators||{},effects:f.effects||{},sensor:f.sensor||{},performance:f.performance||{},system:f.system||{},tuner:f.tuner||{}}):f.type==="oscillator"?i(g=>j(P({},g),{oscillators:j(P({},g.oscillators),{[f.osc]:f})})):f.type==="effect"?i(g=>j(P({},g),{effects:j(P({},g.effects),{[f.effect]:f})})):f.type==="sensor"?i(g=>j(P({},g),{sensor:f})):f.type==="performance"?i(g=>j(P({},g),{performance:f})):f.type==="system"&&i(g=>j(P({},g),{system:f}))}catch(f){console.error("JSON parsing error:",f)}},m.onerror=p=>{console.error("WebSocket error:",p),c("WebSocket connection error")},m.onclose=()=>{console.log("WebSocket disconnected"),a(!1),s(null),_=setTimeout(()=>{console.log("Attempting reconnection..."),x()},3e3)},s(m)}catch(k){console.error("Error creating WebSocket:",k),c(k.message)}};return x(),()=>{_&&clearTimeout(_),m&&m.close()}},[t]);const h=Nt(m=>{n&&o?n.send(typeof m=="string"?m:JSON.stringify(m)):console.warn("WebSocket not connected")},[n,o]),l={connected:o,data:d,error:u,send:h};return Se(ot.Provider,{value:l},e)}function A(){const e=Ft(ot);if(!e)throw new Error("useWebSocket must be used inside WebSocketProvider");return e}function W({title:e,value:t,unit:n,description:s=""}){const[o,a]=S(!1);return r("div",{class:"bg-white dark:bg-gray-800 rounded-lg shadow-md p-6 hover:shadow-lg transition-shadow",children:[r("div",{class:"flex items-center justify-between mb-4",children:[r("h3",{class:"text-sm font-medium text-gray-600 dark:text-gray-400 uppercase tracking-wide",children:e}),s&&r("button",{onClick:()=>a(!o),class:"w-6 h-6 rounded-full bg-blue-500 hover:bg-blue-600 text-white flex items-center justify-center text-sm font-bold transition-colors cursor-pointer","aria-label":"Toggle description",children:"i"})]}),r("div",{class:"flex items-baseline",children:[r("span",{class:"text-3xl font-bold text-gray-900 dark:text-white",children:t!=null?t:"--"}),n&&r("span",{class:"ml-2 text-sm text-gray-500 dark:text-gray-400",children:n})]}),s&&o&&r("div",{class:"text-sm text-blue-800 dark:text-blue-200 mt-4 p-4 bg-blue-50 dark:bg-blue-900 rounded-md",children:s})]})}function lt(){var s,o,a,d,i,u,c,h,l,m,_,x,k,p,f,g,M,O,D,L,I,b,v,F,y,C,R,q,ee,H,Ee,Ce;const{data:e}=A(),t=U=>{if(!U)return"0s";const $=Math.floor(U/1e3),B=Math.floor($/60),z=Math.floor(B/60),$e=Math.floor(z/24);return $e>0?`${$e}d ${z%24}h`:z>0?`${z}h ${B%60}m`:B>0?`${B}m ${$%60}s`:`${$}s`},n=U=>{if(!U)return"0 KB";const $=U/1024;return $>1024?`${($/1024).toFixed(2)} MB`:`${$.toFixed(2)} KB`};return r("div",{class:"max-w-7xl mx-auto px-4 py-8 sm:px-6 lg:px-8",children:[r("section",{class:"mb-8",children:[r("h2",{class:"text-xl font-semibold text-gray-800 dark:text-white mb-4",children:"Oscillators"}),r("div",{class:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[1,2,3].map(U=>{var z;const $=((z=e.oscillators)==null?void 0:z[U])||{},B=$.waveform&&$.waveform!=="OFF";return r("div",{class:"bg-white dark:bg-gray-800 rounded-lg shadow p-6",children:[r("div",{class:"flex items-center justify-between mb-4",children:[r("h3",{class:"text-lg font-medium text-gray-900 dark:text-white",children:["Oscillator ",U]}),r("span",{class:`px-2 py-1 rounded text-xs font-semibold ${B?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"}`,children:B?"ACTIVE":"OFF"})]}),r("div",{class:"space-y-2 text-sm",children:[r("div",{class:"flex justify-between",children:[r("span",{class:"text-gray-600 dark:text-gray-400",children:"Waveform:"}),r("span",{class:"font-medium text-gray-900 dark:text-white",children:$.waveform||"OFF"})]}),r("div",{class:"flex justify-between",children:[r("span",{class:"text-gray-600 dark:text-gray-400",children:"Octave:"}),r("span",{class:"font-medium text-gray-900 dark:text-white",children:$.octave!==void 0?$.octave>0?`+${$.octave}`:$.octave:"0"})]}),r("div",{class:"flex justify-between",children:[r("span",{class:"text-gray-600 dark:text-gray-400",children:"Volume:"}),r("span",{class:"font-medium text-gray-900 dark:text-white",children:$.volume!==void 0?`${Math.round($.volume*100)}%`:"0%"})]})]})]},U)})})]}),r("section",{class:"mb-8",children:[r("h2",{class:"text-xl font-semibold text-gray-800 dark:text-white mb-4",children:"Effects"}),r("div",{class:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[r("div",{class:"bg-white dark:bg-gray-800 rounded-lg shadow p-6",children:[r("div",{class:"flex items-center justify-between mb-4",children:[r("h3",{class:"text-lg font-medium text-gray-900 dark:text-white",children:"Delay"}),r("span",{class:`px-2 py-1 rounded text-xs font-semibold ${(o=(s=e.effects)==null?void 0:s.delay)!=null&&o.enabled?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-800"}`,children:(d=(a=e.effects)==null?void 0:a.delay)!=null&&d.enabled?"ON":"OFF"})]}),((u=(i=e.effects)==null?void 0:i.delay)==null?void 0:u.enabled)&&r("div",{class:"space-y-2 text-sm",children:[r("div",{class:"flex justify-between",children:[r("span",{class:"text-gray-600 dark:text-gray-400",children:"Time:"}),r("span",{class:"font-medium text-gray-900 dark:text-white",children:[e.effects.delay.time||0," ms"]})]}),r("div",{class:"flex justify-between",children:[r("span",{class:"text-gray-600 dark:text-gray-400",children:"Feedback:"}),r("span",{class:"font-medium text-gray-900 dark:text-white",children:[((e.effects.delay.feedback||0)*100).toFixed(0),"%"]})]}),r("div",{class:"flex justify-between",children:[r("span",{class:"text-gray-600 dark:text-gray-400",children:"Mix:"}),r("span",{class:"font-medium text-gray-900 dark:text-white",children:[((e.effects.delay.mix||0)*100).toFixed(0),"%"]})]})]})]}),r("div",{class:"bg-white dark:bg-gray-800 rounded-lg shadow p-6",children:[r("div",{class:"flex items-center justify-between mb-4",children:[r("h3",{class:"text-lg font-medium text-gray-900 dark:text-white",children:"Chorus"}),r("span",{class:`px-2 py-1 rounded text-xs font-semibold ${(h=(c=e.effects)==null?void 0:c.chorus)!=null&&h.enabled?"bg-purple-100 text-purple-800":"bg-gray-100 text-gray-800"}`,children:(m=(l=e.effects)==null?void 0:l.chorus)!=null&&m.enabled?"ON":"OFF"})]}),((x=(_=e.effects)==null?void 0:_.chorus)==null?void 0:x.enabled)&&r("div",{class:"space-y-2 text-sm",children:[r("div",{class:"flex justify-between",children:[r("span",{class:"text-gray-600 dark:text-gray-400",children:"Rate:"}),r("span",{class:"font-medium text-gray-900 dark:text-white",children:[(e.effects.chorus.rate||0).toFixed(1)," Hz"]})]}),r("div",{class:"flex justify-between",children:[r("span",{class:"text-gray-600 dark:text-gray-400",children:"Depth:"}),r("span",{class:"font-medium text-gray-900 dark:text-white",children:(e.effects.chorus.depth||0).toFixed(1)})]}),r("div",{class:"flex justify-between",children:[r("span",{class:"text-gray-600 dark:text-gray-400",children:"Mix:"}),r("span",{class:"font-medium text-gray-900 dark:text-white",children:[((e.effects.chorus.mix||0)*100).toFixed(0),"%"]})]})]})]}),r("div",{class:"bg-white dark:bg-gray-800 rounded-lg shadow p-6",children:[r("div",{class:"flex items-center justify-between mb-4",children:[r("h3",{class:"text-lg font-medium text-gray-900 dark:text-white",children:"Reverb"}),r("span",{class:`px-2 py-1 rounded text-xs font-semibold ${(p=(k=e.effects)==null?void 0:k.reverb)!=null&&p.enabled?"bg-indigo-100 text-indigo-800":"bg-gray-100 text-gray-800"}`,children:(g=(f=e.effects)==null?void 0:f.reverb)!=null&&g.enabled?"ON":"OFF"})]}),((O=(M=e.effects)==null?void 0:M.reverb)==null?void 0:O.enabled)&&r("div",{class:"space-y-2 text-sm",children:[r("div",{class:"flex justify-between",children:[r("span",{class:"text-gray-600 dark:text-gray-400",children:"Room Size:"}),r("span",{class:"font-medium text-gray-900 dark:text-white",children:[((e.effects.reverb.roomSize||0)*100).toFixed(0),"%"]})]}),r("div",{class:"flex justify-between",children:[r("span",{class:"text-gray-600 dark:text-gray-400",children:"Damping:"}),r("span",{class:"font-medium text-gray-900 dark:text-white",children:[((e.effects.reverb.damping||0)*100).toFixed(0),"%"]})]}),r("div",{class:"flex justify-between",children:[r("span",{class:"text-gray-600 dark:text-gray-400",children:"Mix:"}),r("span",{class:"font-medium text-gray-900 dark:text-white",children:[((e.effects.reverb.mix||0)*100).toFixed(0),"%"]})]})]})]})]})]}),r("section",{class:"mb-8",children:[r("h2",{class:"text-xl font-semibold text-gray-800 dark:text-white mb-4",children:"System Performance"}),r("div",{class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[r(W,{title:"Free RAM",value:n((D=e.performance)==null?void 0:D.ram),unit:""}),r(W,{title:"Audio Task",value:((L=e.performance)==null?void 0:L.audioTime)!==void 0&&((I=e.performance)==null?void 0:I.maxAudioTime)!==void 0?`${e.performance.audioTime.toFixed(2)} / ${e.performance.maxAudioTime.toFixed(2)}`:"0.00 / 0.00",unit:"ms",description:"This is the time that the audio task takes, compared to the maximum available time calculated on buffer and sample values, es. 256 / 22050 * 1000 = 11.61 ms"}),r(W,{title:"Uptime",value:t((b=e.performance)==null?void 0:b.uptime),unit:""}),r(W,{title:"Connection",value:((v=e.sensor)==null?void 0:v.pitch)!==void 0?"Active":"Waiting",unit:""})]})]}),r("section",{class:"mb-8",children:[r("h2",{class:"text-xl font-semibold text-gray-800 dark:text-white mb-4",children:"System Settings"}),r("div",{class:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[r(W,{title:"Pitch Smoothing",value:((F=e.system)==null?void 0:F.pitchSmoothing)===0?"None":((y=e.system)==null?void 0:y.pitchSmoothing)===2?"Extra":"Normal",unit:""}),r(W,{title:"Volume Smoothing",value:((C=e.system)==null?void 0:C.volumeSmoothing)===0?"None":((R=e.system)==null?void 0:R.volumeSmoothing)===2?"Extra":"Normal",unit:""}),r(W,{title:"Frequency Range",value:((q=e.system)==null?void 0:q.frequencyRange)===0?"Narrow":((ee=e.system)==null?void 0:ee.frequencyRange)===2?"Wide":"Normal",unit:""})]})]}),((H=e.sensor)==null?void 0:H.pitch)!==void 0&&r("section",{class:"mb-8",children:[r("h2",{class:"text-xl font-semibold text-gray-800 dark:text-white mb-4",children:"Sensor Readings"}),r("div",{class:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r(W,{title:"Pitch Distance",value:((Ee=e.sensor.pitch)==null?void 0:Ee.toFixed(1))||"0",unit:"mm"}),r(W,{title:"Volume Distance",value:((Ce=e.sensor.volume)==null?void 0:Ce.toFixed(1))||"0",unit:"mm"})]})]}),r("section",{class:"mt-8",children:r("details",{class:"bg-white dark:bg-gray-800 rounded-lg shadow p-4",children:[r("summary",{class:"cursor-pointer font-medium text-gray-700 dark:text-gray-300",children:"Debug: Raw WebSocket Data"}),r("pre",{class:"mt-4 p-4 bg-gray-100 dark:bg-gray-900 rounded overflow-auto text-xs text-gray-900 dark:text-gray-100",children:JSON.stringify(e,null,2)})]})})]})}function Mt({label:e,dataKey:t,onCommand:n,offCommand:s,value:o}){const{data:a,send:d}=A(),[i,u]=S(o!==void 0?o:!1);return T(()=>{a&&t&&a[t]!==void 0&&u(!!a[t])},[a,t]),T(()=>{o!==void 0&&u(o)},[o]),r("div",{class:"flex items-center justify-between p-4 bg-white dark:bg-gray-800 rounded-lg shadow",children:[r("span",{class:"text-gray-700 dark:text-gray-300 font-medium",children:e}),r("button",{onClick:()=>{const h=!i;u(h),h&&n?d(typeof n=="string"?{command:n}:n):!h&&s&&d(typeof s=="string"?{command:s}:s)},class:`
          relative inline-flex h-8 w-14 items-center rounded-full
          transition-colors duration-200 ease-in-out
          focus:outline-none focus:ring-2 focus:ring-blue-500 dark:focus:ring-blue-400 focus:ring-offset-2 dark:focus:ring-offset-gray-800
          ${i?"bg-blue-500 dark:bg-blue-600":"bg-gray-300 dark:bg-gray-600"}
        `,children:r("span",{class:`
            inline-block h-6 w-6 transform rounded-full bg-white
            transition-transform duration-200 ease-in-out
            ${i?"translate-x-7":"translate-x-1"}
          `})})]})}function Q({label:e,options:t,value:n,onChange:s,commandGenerator:o,dataKey:a}){const{data:d,send:i}=A(),[u,c]=S(n);return T(()=>{d&&a&&d[a]!==void 0&&(c(d[a]),s&&s(d[a]))},[d,a,s]),T(()=>{c(n)},[n]),r("div",{class:"flex items-center justify-between p-4 bg-white dark:bg-gray-800 rounded-lg shadow",children:[r("span",{class:"text-gray-700 dark:text-gray-300 font-medium",children:e}),r("select",{value:u,onChange:l=>{const m=l.target.value;if(c(m),s&&s(m),o){const _=o(m);i(_)}},class:"px-3 py-2 bg-gray-50 dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-md text-gray-700 dark:text-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-500 dark:focus:ring-blue-400 focus:border-blue-500 dark:focus:border-blue-400 transition-colors",children:t.map(l=>r("option",{value:l,children:l},l))})]})}function it({label:e,value:t,onChange:n,commandGenerator:s,dataKey:o,min:a=0,max:d=100,step:i=1,unit:u="%"}){const{data:c,send:h}=A(),[l,m]=S(t);T(()=>{c&&o&&c[o]!==void 0&&(m(c[o]),n&&n(c[o]))},[c,o,n]),T(()=>{m(t)},[t]);const _=p=>{const f=parseFloat(p.target.value);if(m(f),n&&n(f),s){const g=s(f);h(g)}},x=d>a?(l-a)/(d-a)*100:0,k=i>=1?Math.round(l):l.toFixed(2);return r("div",{class:"flex flex-col p-4 bg-white dark:bg-gray-800 rounded-lg shadow space-y-2",children:[r("div",{class:"flex items-center justify-between",children:[r("span",{class:"text-gray-700 dark:text-gray-300 font-medium",children:e}),r("span",{class:"text-gray-600 dark:text-gray-400 text-sm font-mono",children:[k,u]})]}),r("input",{type:"range",min:a,max:d,step:i,value:l,onChange:_,class:"w-full h-2 bg-gray-200 dark:bg-gray-700 rounded-lg appearance-none cursor-pointer slider",style:{background:`linear-gradient(to right, #3B82F6 0%, #3B82F6 ${x}%, ${document.documentElement.classList.contains("dark")?"#374151":"#E5E7EB"} ${x}%, ${document.documentElement.classList.contains("dark")?"#374151":"#E5E7EB"} 100%)`}})]})}function he({id:e}){const{data:t}=A(),[n,s]=S("SINE"),[o,a]=S(100),[d,i]=S("0");return T(()=>{var h;const c=(h=t.oscillators)==null?void 0:h[e];c&&(c.waveform&&s(c.waveform),c.volume!==void 0&&a(Math.round(c.volume*100)),c.octave!==void 0&&i(String(c.octave)))},[t.oscillators,e]),r("div",{class:"space-y-4",children:[r("h3",{class:"text-lg font-medium text-gray-900 dark:text-white flex items-center gap-2",children:[r("span",{class:`w-2 h-2 rounded-full ${n&&n!=="OFF"?"bg-green-500":"bg-red-500"}`}),"Oscillator ",e]}),r(Q,{label:"Waveform",options:["OFF","SINE","SQUARE","TRIANGLE","SAW"],value:n,onChange:s,commandGenerator:c=>({cmd:"setWaveform",osc:e,value:c})}),r(Q,{label:"Octave",options:["-1","0","1"],value:d,onChange:i,commandGenerator:c=>({cmd:"setOctave",osc:e,value:parseInt(c,10)})}),r(it,{label:"Volume",value:o,onChange:a,min:0,max:100,step:1,unit:"%",commandGenerator:c=>({cmd:"setVolume",osc:e,value:c/100})})]})}function Ot(){return r("div",{class:"max-w-7xl mx-auto px-4 py-8 sm:px-6 lg:px-8",children:r("section",{class:"mb-8",children:[r("h2",{class:"text-xl font-semibold text-gray-800 dark:text-white mb-4",children:"Oscillators"}),r("div",{class:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[r("div",{class:"bg-white dark:bg-gray-800 rounded-lg shadow p-6",children:r(he,{id:1})}),r("div",{class:"bg-white dark:bg-gray-800 rounded-lg shadow p-6",children:r(he,{id:2})}),r("div",{class:"bg-white dark:bg-gray-800 rounded-lg shadow p-6",children:r(he,{id:3})})]})]})})}function fe({effectName:e}){const{data:t}=A(),s={delay:{displayName:"Delay",parameters:[{name:"time",label:"Delay Time",min:10,max:2e3,step:10,unit:"ms",defaultValue:300},{name:"feedback",label:"Feedback",min:0,max:.95,step:.01,unit:"",defaultValue:.5},{name:"mix",label:"Mix",min:0,max:1,step:.01,unit:"",defaultValue:.3}]},chorus:{displayName:"Chorus",parameters:[{name:"rate",label:"Rate",min:.1,max:10,step:.1,unit:"Hz",defaultValue:2},{name:"depth",label:"Depth",min:1,max:50,step:1,unit:"ms",defaultValue:15},{name:"mix",label:"Mix",min:0,max:1,step:.01,unit:"",defaultValue:.5}]},reverb:{displayName:"Reverb",parameters:[{name:"roomSize",label:"Room Size",min:0,max:1,step:.01,unit:"",defaultValue:.5},{name:"damping",label:"Damping",min:0,max:1,step:.01,unit:"",defaultValue:.5},{name:"mix",label:"Mix",min:0,max:1,step:.01,unit:"",defaultValue:.3}]}}[e],[o,a]=S(s.parameters.reduce((i,u)=>(i[u.name]=u.defaultValue,i),{}));T(()=>{var u;const i=(u=t.effects)==null?void 0:u[e];if(i){const c={};s.parameters.forEach(h=>{i[h.name]!==void 0&&(c[h.name]=i[h.name])}),Object.keys(c).length>0&&a(h=>P(P({},h),c))}},[t.effects,e,s.parameters]);const d=(i,u)=>{a(c=>j(P({},c),{[i]:u}))};return r("div",{class:"space-y-4",children:[r(Mt,{label:"Enable",onCommand:{cmd:"enableEffect",effect:e,value:!0},offCommand:{cmd:"enableEffect",effect:e,value:!1}}),s.parameters.map(i=>r(it,{label:i.label,value:o[i.name],onChange:u=>d(i.name,u),min:i.min,max:i.max,step:i.step,unit:i.unit,commandGenerator:u=>({cmd:"setEffectParam",effect:e,param:i.name,value:u})},i.name))]})}function Tt(){const{data:e}=A();return r("div",{class:"max-w-7xl mx-auto px-4 py-8 sm:px-6 lg:px-8",children:r("section",{class:"mb-8",children:[r("h2",{class:"text-xl font-semibold text-gray-800 dark:text-white mb-4",children:"Effects"}),r("div",{class:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[r("div",{class:"bg-white dark:bg-gray-800 rounded-lg shadow p-6",children:[r("h3",{class:"text-lg font-medium text-gray-900 dark:text-white mb-4",children:"Delay"}),r(fe,{effectName:"delay"})]}),r("div",{class:"bg-white dark:bg-gray-800 rounded-lg shadow p-6",children:[r("h3",{class:"text-lg font-medium text-gray-900 dark:text-white mb-4",children:"Chorus"}),r(fe,{effectName:"chorus"})]}),r("div",{class:"bg-white dark:bg-gray-800 rounded-lg shadow p-6",children:[r("h3",{class:"text-lg font-medium text-gray-900 dark:text-white mb-4",children:"Reverb"}),r(fe,{effectName:"reverb"})]})]})]})})}function Dt(){var c,h,l,m,_,x,k;const{data:e}=A(),[t,n]=S("1"),[s,o]=S("1"),[a,d]=S("1");T(()=>{e.system&&(e.system.pitchSmoothing!==void 0&&n(String(e.system.pitchSmoothing)),e.system.volumeSmoothing!==void 0&&o(String(e.system.volumeSmoothing)),e.system.frequencyRange!==void 0&&d(String(e.system.frequencyRange)))},[e.system]);const i=[{value:"0",label:"None (Instant)"},{value:"1",label:"Normal (Balanced)"},{value:"2",label:"Extra (Smooth)"}],u=[{value:"0",label:"Narrow (1 Octave)"},{value:"1",label:"Normal (2 Octaves)"},{value:"2",label:"Wide (3 Octaves)"}];return r("div",{class:"max-w-7xl mx-auto px-4 py-8 sm:px-6 lg:px-8",children:[r("section",{class:"mb-8",children:[r("h2",{class:"text-xl font-semibold text-gray-800 dark:text-white mb-4",children:"Sensor Readings"}),r("div",{class:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r(W,{title:"Pitch Distance",value:((h=(c=e.sensor)==null?void 0:c.pitch)==null?void 0:h.toFixed(1))||"0",unit:"mm"}),r(W,{title:"Volume Distance",value:((m=(l=e.sensor)==null?void 0:l.volume)==null?void 0:m.toFixed(1))||"0",unit:"mm"})]})]}),r("section",{class:"mb-8",children:[r("h2",{class:"text-xl font-semibold text-gray-800 dark:text-white mb-4",children:"Smoothing Configuration"}),r("div",{class:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r("div",{class:"bg-white dark:bg-gray-800 rounded-lg shadow p-6",children:[r("h3",{class:"text-lg font-medium text-gray-900 dark:text-white mb-4",children:"Pitch Smoothing"}),r("p",{class:"text-sm text-gray-600 dark:text-gray-400 mb-4",children:"Controls how smoothly the pitch responds to hand movement."}),r(Q,{label:"Smoothing Level",options:i.map(p=>p.label),value:((_=i.find(p=>p.value===t))==null?void 0:_.label)||"Normal (Balanced)",onChange:p=>{const f=i.find(g=>g.label===p);f&&n(f.value)},commandGenerator:p=>{const f=i.find(g=>g.label===p);return{cmd:"setSmoothing",target:"pitch",value:parseInt((f==null?void 0:f.value)||"1",10)}}})]}),r("div",{class:"bg-white dark:bg-gray-800 rounded-lg shadow p-6",children:[r("h3",{class:"text-lg font-medium text-gray-900 dark:text-white mb-4",children:"Volume Smoothing"}),r("p",{class:"text-sm text-gray-600 dark:text-gray-400 mb-4",children:"Controls how smoothly the volume responds to hand movement."}),r(Q,{label:"Smoothing Level",options:i.map(p=>p.label),value:((x=i.find(p=>p.value===s))==null?void 0:x.label)||"Normal (Balanced)",onChange:p=>{const f=i.find(g=>g.label===p);f&&o(f.value)},commandGenerator:p=>{const f=i.find(g=>g.label===p);return{cmd:"setSmoothing",target:"volume",value:parseInt((f==null?void 0:f.value)||"1",10)}}})]})]})]}),r("section",{class:"mb-8",children:[r("h2",{class:"text-xl font-semibold text-gray-800 dark:text-white mb-4",children:"Frequency Range"}),r("div",{class:"bg-white dark:bg-gray-800 rounded-lg shadow p-6",children:[r("h3",{class:"text-lg font-medium text-gray-900 dark:text-white mb-4",children:"Playing Range"}),r("p",{class:"text-sm text-gray-600 dark:text-gray-400 mb-4",children:"Sets the frequency range (musical pitch range) of the theremin."}),r(Q,{label:"Range Preset",options:u.map(p=>p.label),value:((k=u.find(p=>p.value===a))==null?void 0:k.label)||"Normal (2 Octaves)",onChange:p=>{const f=u.find(g=>g.label===p);f&&d(f.value)},commandGenerator:p=>{const f=u.find(g=>g.label===p);return{cmd:"setRange",value:parseInt((f==null?void 0:f.value)||"1",10)}}}),r("div",{class:"mt-4 p-4 bg-blue-50 dark:bg-blue-900 rounded-md",children:r("p",{class:"text-sm text-blue-800 dark:text-blue-200",children:[r("strong",{children:"Narrow:"})," 1 octave range - tight playing area for precise control",r("br",{}),r("strong",{children:"Normal:"})," 2 octaves range - balanced (default)",r("br",{}),r("strong",{children:"Wide:"})," 3 octaves range - extended range for expressive playing"]})})]})]})]})}function Pt(){const{data:e}=A(),t=e.tuner,n=t&&t.frequency&&t.frequency>=20;return r("div",{className:"space-y-6",children:[r("h2",{className:"text-2xl font-bold",children:"Tuner"}),n?r(Z,{children:[r("div",{className:"bg-gray-800 rounded-lg p-8 text-center",children:[r("div",{className:"text-6xl font-bold mb-2",children:t.note}),r("div",{className:"text-xl text-gray-400",children:[t.frequency.toFixed(1)," Hz"]})]}),r("div",{className:"bg-gray-800 rounded-lg p-6",children:[r("div",{className:"mb-4 text-center",children:[r("span",{className:"text-lg font-semibold",children:[t.cents>0?"+":"",t.cents," cents"]}),r("span",{className:`ml-3 px-3 py-1 rounded text-sm font-medium ${t.inTune?"bg-green-500/20 text-green-400":Math.abs(t.cents)>25?"bg-red-500/20 text-red-400":"bg-yellow-500/20 text-yellow-400"}`,children:t.inTune?"IN TUNE":t.cents<0?"FLAT":"SHARP"})]}),r("div",{className:"relative h-12 bg-gray-700 rounded-lg overflow-hidden",children:[r("div",{className:"absolute left-1/2 top-0 bottom-0 w-0.5 bg-gray-500 z-10"}),r("div",{className:"absolute top-0 bottom-0 bg-green-500/20",style:{left:"45%",width:"10%"}}),r("div",{className:`absolute top-0 bottom-0 w-1 transition-all duration-100 ${t.inTune?"bg-green-400":"bg-blue-400"}`,style:{left:`${50+t.cents*.4}%`,transform:"translateX(-50%)"},children:r("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2",children:r("div",{className:"w-0 h-0 border-l-[6px] border-l-transparent border-r-[6px] border-r-transparent border-t-[8px] border-t-current"})})}),r("div",{className:"absolute inset-x-0 bottom-1 flex justify-between px-2 text-xs text-gray-500",children:[r("span",{children:"-50"}),r("span",{children:"-25"}),r("span",{className:"text-gray-400",children:"0"}),r("span",{children:"+25"}),r("span",{children:"+50"})]})]})]}),r("div",{className:"bg-gray-800 rounded-lg p-4",children:r("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[r("div",{children:[r("span",{className:"text-gray-400",children:"Note Name:"}),r("span",{className:"ml-2 font-medium",children:t.noteName})]}),r("div",{children:[r("span",{className:"text-gray-400",children:"Octave:"}),r("span",{className:"ml-2 font-medium",children:t.octave})]})]})})]}):r("div",{className:"bg-gray-800 rounded-lg p-8 text-center",children:[r("p",{className:"text-gray-400 text-lg",children:"No signal detected"}),r("p",{className:"text-gray-500 text-sm mt-2",children:"Play a note to see tuning information"})]}),r("div",{className:"bg-gray-800/50 rounded-lg p-4 text-sm text-gray-400",children:[r("p",{className:"mb-2",children:r("strong",{className:"text-gray-300",children:"About the Tuner:"})}),r("ul",{className:"list-disc list-inside space-y-1 ml-2",children:[r("li",{children:"The tuner calculates note information directly from the theremin's frequency"}),r("li",{children:"No microphone needed - data comes directly from the ESP32"}),r("li",{children:'"In tune" means within ¬±10 cents of perfect pitch'}),r("li",{children:"100 cents = 1 semitone (musical half-step)"})]})]})]})}const Y=[{value:1.5,label:"1.5 Octaves - C4-G5",notes:20,baseNote:60},{value:2,label:"2 Octaves - F3-F5",notes:25,baseNote:53},{value:2.5,label:"2.5 Octaves - C3-G5",notes:32,baseNote:48},{value:3,label:"3 Octaves - G2-G5",notes:37,baseNote:43},{value:4,label:"4 Octaves - C2-C6",notes:49,baseNote:36}],ct=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"],re=e=>ct[e%12].includes("#"),me=e=>{const t=e%12,n=Math.floor(e/12)-1;return`${ct[t]}${n}`},_e={a:60,s:62,d:64,f:65,g:67,h:69,j:71,k:72,w:61,e:63,t:66,y:68,u:70};function Wt(){const{send:e,state:t}=A(),[n,s]=S(1.5),[o,a]=S(null),[d,i]=S(new Set),[u,c]=S(100),[h,l]=S(!0),[m,_]=S(null),x=Y.find(b=>b.value===n)||Y[1],k=Array.from({length:x.notes},(b,v)=>x.baseNote+v),p=b=>{const v=Object.entries(_e).find(([F,y])=>y===b);return v?v[0].toUpperCase():""},f=b=>{const v=Y.find(q=>q.value===b)||Y[1],F=v.baseNote,y=v.baseNote+v.notes-1,C=Math.round(440*Math.pow(2,(F-69)/12)),R=Math.round(440*Math.pow(2,(y-69)/12));return{minFreq:C,maxFreq:R}},g=b=>{o!==b&&(a(b),e({cmd:"playNote",note:b}),e({cmd:"setAmplitude",value:u}))},M=()=>{a(null),e({cmd:"stopNote"}),e({cmd:"setAmplitude",value:0})},O=b=>{g(b)},D=()=>{M()};T(()=>{var b,v;(b=t==null?void 0:t.system)!=null&&b.minFrequency&&((v=t==null?void 0:t.system)!=null&&v.maxFrequency)&&!m&&_({min:t.system.minFrequency,max:t.system.maxFrequency})},[t]),T(()=>{e({cmd:"setSensorEnabled",sensor:"both",enabled:!1});const{minFreq:b,maxFreq:v}=f(n);return e({cmd:"setFrequencyRange",minFreq:b,maxFreq:v}),()=>{m&&e({cmd:"setFrequencyRange",minFreq:m.min,maxFreq:m.max}),e({cmd:"setSensorEnabled",sensor:"both",enabled:!0}),M()}},[m]),T(()=>{const{minFreq:b,maxFreq:v}=f(n);e({cmd:"setFrequencyRange",minFreq:b,maxFreq:v})},[n]),T(()=>{if(!h)return;const b=F=>{if(F.target.tagName==="INPUT"||F.target.tagName==="SELECT")return;const y=F.key.toLowerCase(),C=_e[y];C&&!d.has(y)&&(F.preventDefault(),i(R=>new Set(R).add(y)),g(C))},v=F=>{const y=F.key.toLowerCase();_e[y]&&d.has(y)&&(F.preventDefault(),i(R=>{const q=new Set(R);return q.delete(y),q}),M())};return window.addEventListener("keydown",b),window.addEventListener("keyup",v),()=>{window.removeEventListener("keydown",b),window.removeEventListener("keyup",v)}},[h,d,u]);const L=()=>k.filter(b=>!re(b-x.baseNote)).map(b=>{const v=o===b,F=me(b);return r("button",{class:`white-key ${v?"active":""}`,onMouseDown:()=>O(b),onMouseUp:D,onMouseLeave:D,onTouchStart:y=>{y.preventDefault(),O(b)},onTouchEnd:y=>{y.preventDefault(),D()},children:[r("span",{class:"key-label",children:F}),h&&p(b)&&r("span",{class:"keyboard-shortcut",children:p(b)})]},b)}),I=()=>{const v=100/k.filter(y=>!re(y-x.baseNote)).length,F=v*.6;return k.filter(y=>re(y-x.baseNote)).map(y=>{const C=o===y,R=me(y),ee=`${(k.slice(0,y-x.baseNote).filter(H=>!re(H-x.baseNote)).length-1)*v+v*.65}%`;return r("button",{class:`black-key ${C?"active":""}`,style:{left:ee,width:`${F}%`},onMouseDown:()=>O(y),onMouseUp:D,onMouseLeave:D,onTouchStart:H=>{H.preventDefault(),O(y)},onTouchEnd:H=>{H.preventDefault(),D()},children:[r("span",{class:"key-label",children:R}),h&&p(y)&&r("span",{class:"keyboard-shortcut",children:p(y)})]},y)})};return r("div",{class:"p-6 max-w-7xl mx-auto",children:[r("div",{class:"mb-6",children:[r("h2",{class:"text-2xl font-bold text-gray-800 dark:text-white mb-2",children:"Keyboard"}),r("p",{class:"text-gray-600 dark:text-gray-400",children:"Play the theremin with a virtual piano keyboard"})]}),r("div",{class:"mb-6 bg-white dark:bg-gray-800 rounded-lg p-4 shadow",children:r("div",{class:"flex flex-col gap-4",children:[r("div",{class:"flex items-center gap-4",children:[r("label",{class:"text-sm font-medium text-gray-700 dark:text-gray-300 whitespace-nowrap",children:"Octave Range:"}),r("select",{value:n,onChange:b=>{M(),s(parseFloat(b.target.value))},class:"px-3 py-2 bg-gray-100 dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-lg text-gray-800 dark:text-white focus:ring-2 focus:ring-blue-500",children:Y.map(b=>r("option",{value:b.value,children:b.label},b.value))}),r("div",{class:"ml-auto text-sm text-gray-600 dark:text-gray-400",children:o!==null?r("span",{class:"font-medium text-blue-600 dark:text-blue-400",children:["Playing: ",me(o)," (MIDI ",o,")"]}):r("span",{children:"Click or tap keys to play"})})]}),r("div",{class:"flex items-center gap-4",children:[r("label",{class:"text-sm font-medium text-gray-700 dark:text-gray-300 whitespace-nowrap",children:["Volume: ",u,"%"]}),r("input",{type:"range",min:"0",max:"100",value:u,onChange:b=>c(parseInt(b.target.value)),class:"flex-1 h-2 bg-gray-200 dark:bg-gray-700 rounded-lg appearance-none cursor-pointer",style:{background:`linear-gradient(to right, #3b82f6 0%, #3b82f6 ${u}%, #e5e7eb ${u}%, #e5e7eb 100%)`}})]}),r("div",{class:"flex items-center gap-4",children:[r("label",{class:"text-sm font-medium text-gray-700 dark:text-gray-300 whitespace-nowrap",children:"Keyboard Shortcuts"}),r("label",{class:"relative inline-flex items-center cursor-pointer",children:[r("input",{type:"checkbox",checked:h,onChange:b=>l(b.target.checked),class:"sr-only peer"}),r("div",{class:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-blue-600"})]}),r("span",{class:"text-xs text-gray-500 dark:text-gray-400",children:h?"Enabled":"Disabled"})]})]})}),r("div",{class:"bg-white dark:bg-gray-800 rounded-lg p-6 shadow-lg",children:r("div",{class:"keyboard-container",children:[r("div",{class:"white-keys",children:L()}),r("div",{class:"black-keys",children:I()})]})}),h&&r("div",{class:"mt-4 bg-blue-50 dark:bg-blue-900/20 rounded-lg p-4 border border-blue-200 dark:border-blue-800",children:[r("h3",{class:"text-sm font-semibold text-blue-900 dark:text-blue-100 mb-2",children:"‚å®Ô∏è Keyboard Shortcuts (1 Octave)"}),r("div",{class:"grid grid-cols-2 gap-4 text-xs text-blue-800 dark:text-blue-200",children:[r("div",{children:[r("p",{class:"font-medium mb-1",children:"White Keys (Naturals):"}),r("div",{class:"font-mono space-y-0.5",children:[r("div",{children:"A = C4 | S = D4 | D = E4 | F = F4"}),r("div",{children:"G = G4 | H = A4 | J = B4 | K = C5"})]})]}),r("div",{children:[r("p",{class:"font-medium mb-1",children:"Black Keys (Sharps):"}),r("div",{class:"font-mono space-y-0.5",children:[r("div",{children:"W = C#4 | E = D#4"}),r("div",{children:"T = F#4 | Y = G#4 | U = A#4"})]})]})]})]}),r("div",{class:"mt-4 text-sm text-gray-600 dark:text-gray-400",children:r("p",{children:["üí° ",r("strong",{children:"Tip:"})," Use this keyboard to test effects, try different waveforms, and experiment with the synthesizer. Sensors are automatically disabled while using the keyboard."]})}),r("style",{jsx:!0,children:`
        .keyboard-container {
          position: relative;
          height: 200px;
          overflow-x: auto;
          overflow-y: hidden;
        }

        .white-keys {
          display: flex;
          gap: 2px;
          height: 100%;
        }

        .white-key {
          flex: 1;
          min-width: 40px;
          height: 100%;
          background: linear-gradient(to bottom, #ffffff 0%, #f0f0f0 100%);
          border: 2px solid #333;
          border-radius: 0 0 8px 8px;
          cursor: pointer;
          position: relative;
          transition: all 0.05s ease;
          display: flex;
          align-items: flex-end;
          justify-content: center;
          padding-bottom: 8px;
          user-select: none;
          -webkit-tap-highlight-color: transparent;
        }

        .white-key:hover {
          background: linear-gradient(to bottom, #f0f0f0 0%, #e0e0e0 100%);
          transform: translateY(2px);
        }

        .white-key.active {
          background: linear-gradient(to bottom, #4ade80 0%, #22c55e 100%);
          transform: translateY(4px);
          box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.3);
        }

        .black-keys {
          position: absolute;
          top: 0;
          left: 0;
          right: 0;
          height: 60%;
          pointer-events: none;
        }

        .black-key {
          position: absolute;
          width: 7%;
          height: 100%;
          background: linear-gradient(to bottom, #000 0%, #333 100%);
          border: 2px solid #000;
          border-radius: 0 0 6px 6px;
          cursor: pointer;
          pointer-events: auto;
          transition: all 0.05s ease;
          display: flex;
          align-items: flex-end;
          justify-content: center;
          padding-bottom: 6px;
          user-select: none;
          -webkit-tap-highlight-color: transparent;
          z-index: 10;
        }

        .black-key:hover {
          background: linear-gradient(to bottom, #333 0%, #555 100%);
          transform: translateY(2px);
        }

        .black-key.active {
          background: linear-gradient(to bottom, #22c55e 0%, #16a34a 100%);
          transform: translateY(3px);
          box-shadow: inset 0 2px 6px rgba(0, 0, 0, 0.5);
        }

        .key-label {
          font-size: 0.75rem;
          font-weight: 600;
          color: #666;
          pointer-events: none;
        }

        .keyboard-shortcut {
          position: absolute;
          top: 8px;
          right: 8px;
          font-size: 0.7rem;
          font-weight: 700;
          color: #3b82f6;
          background: rgba(255, 255, 255, 0.9);
          padding: 2px 6px;
          border-radius: 4px;
          pointer-events: none;
          box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }

        .black-key .key-label {
          color: #fff;
        }

        .black-key .keyboard-shortcut {
          background: rgba(59, 130, 246, 0.9);
          color: white;
        }

        .white-key.active .key-label,
        .black-key.active .key-label {
          color: white;
        }

        .white-key.active .keyboard-shortcut,
        .black-key.active .keyboard-shortcut {
          background: rgba(255, 255, 255, 0.95);
          color: #16a34a;
        }

        /* Responsive adjustments */
        @media (max-width: 768px) {
          .keyboard-container {
            height: 150px;
          }

          .white-key {
            min-width: 30px;
          }

          .key-label {
            font-size: 0.65rem;
          }

          .keyboard-shortcut {
            font-size: 0.6rem;
            padding: 1px 4px;
            top: 4px;
            right: 4px;
          }
        }
      `})]})}function At({setView:e,views:t,defaultView:n,currentView:s,darkMode:o,setDarkMode:a}){const{connected:d}=A(),[i,u]=S(!1),c=h=>{e(h),u(!1)};return r("header",{class:"bg-white dark:bg-gray-800 shadow-md",children:r("div",{class:"max-w-7xl mx-auto px-4 py-4 sm:px-6 lg:px-8",children:[r("div",{class:"flex items-center justify-between",children:[r("h1",{class:"text-2xl font-bold text-gray-900 dark:text-white cursor-pointer hover:text-gray-700 dark:hover:text-gray-300 transition-colors",onClick:()=>e(n),children:"Therem[AI]n Control Panel"}),r("div",{class:"flex items-center gap-4",children:[r("nav",{class:"hidden md:flex gap-2",children:t.map(h=>{const l=h.id===s;return r("button",{onClick:()=>e(h.id),class:`px-4 py-2 text-sm font-medium rounded-md transition-colors ${l?"bg-blue-100 dark:bg-blue-900 text-blue-700 dark:text-blue-200 hover:bg-blue-200 dark:hover:bg-blue-800":"text-gray-700 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700"}`,children:h.label},h.id)})}),r("button",{onClick:()=>a(!o),class:"p-2 text-gray-700 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md transition-colors","aria-label":"Toggle dark mode",children:r("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o?r("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"}):r("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"})})}),r("button",{onClick:()=>u(!i),class:"md:hidden p-2 text-gray-700 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md transition-colors","aria-label":"Toggle menu",children:r("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i?r("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"}):r("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})}),r("div",{class:"flex items-center gap-2",children:[r("div",{class:`w-3 h-3 rounded-full ${d?"bg-green-500":"bg-red-500"}`}),r("span",{class:"text-sm text-gray-600 dark:text-gray-400 hidden sm:inline",children:d?"Connected":"Disconnected"})]})]})]}),i&&r("nav",{class:"md:hidden mt-4 pb-2 border-t border-gray-200 dark:border-gray-700 pt-4",children:r("div",{class:"flex flex-col gap-2",children:t.map(h=>{const l=h.id===s;return r("button",{onClick:()=>c(h.id),class:`w-full text-left px-4 py-3 text-sm font-medium rounded-md transition-colors ${l?"bg-blue-100 dark:bg-blue-900 text-blue-700 dark:text-blue-200 hover:bg-blue-200 dark:hover:bg-blue-800":"text-gray-700 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700"}`,children:h.label},h.id)})})})]})})}const ve=[{id:"dashboard",label:"Dashboard",component:lt,default:!0},{id:"oscillators",label:"Oscillators",component:Ot},{id:"effects",label:"Effects",component:Tt},{id:"sensors",label:"Sensors",component:Dt},{id:"tuner",label:"Tuner",component:Pt},{id:"keyboard",label:"Keyboard",component:Wt}];var Ie;const He=((Ie=ve.find(e=>e.default))==null?void 0:Ie.id)||"dashboard";function Lt(){const t=new URLSearchParams(window.location.search).get("ws");if(t){const n=`ws://${t}/ws`;return console.log("[WebSocket] Using URL parameter:",n),{url:n,isOverridden:!0,source:t}}return console.log("[WebSocket] Using default (window.location.hostname)"),{url:void 0,isOverridden:!1,source:null}}function Rt(){var d;const[e,t]=S(He),[n,s]=S(()=>{const i=localStorage.getItem("darkMode");return i?JSON.parse(i):!0});T(()=>{n?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark"),localStorage.setItem("darkMode",JSON.stringify(n))},[n]);const o=((d=ve.find(i=>i.id===e))==null?void 0:d.component)||lt,a=Lt();return r($t,{url:a.url,children:r("div",{class:"min-h-screen bg-gray-100 dark:bg-gray-900",children:[a.isOverridden&&r("div",{class:"bg-yellow-500 text-black px-4 py-2 text-center text-sm font-medium",children:["‚ö†Ô∏è Development Mode: Connected to ",a.source]}),r(At,{setView:t,views:ve.map(i=>({id:i.id,label:i.label})),defaultView:He,currentView:e,darkMode:n,setDarkMode:s}),r(o,{})]})})}xt(Se(Rt),document.getElementById("app"));
